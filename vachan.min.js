const vachan={};vachan.Pending=Symbol("Pending"),vachan.Fulfilled=Symbol("Fulfilled"),vachan.Rejected=Symbol("Rejected"),vachan.Macro=Symbol("Macro"),vachan.Micro=Symbol("Micro"),vachan.default_type=vachan.Macro;class P{static resolve(e){return new P(t=>t(e))}static reject(e){return new P((t,a)=>a(e))}static all(...e){return 1==e.length&&Array.isArray(e[0])&&(e=e[0]),new P(t=>{let a=0,n=[];function s(s){a++,n.push(s),a==e.length&&t(n)}for(let t of e)t.then(s,s)})}static race(...e){return 1==e.length&&Array.isArray(e[0])&&(e=e[0]),new P(t=>{let a=!1;function n(e){a||(a=!0,t(e))}for(let t of e)t.then(n,n)})}constructor(e,t=!0,a=vachan.default_type){this.async=t,this.type=a,this.state=vachan.Pending,this.value=void 0,this.success_handler=[],this.failure_handler=[],e&&(this.logic=e,this.logic(e=>this.resolve(e),e=>this.reject(e),this))}isFullfilled(){return this.state===vachan.Fulfilled}isRejected(){return this.state===vachan.Rejected}isPending(){return this.state===vachan.Pending}resolve(e){if(this.state===vachan.Pending){this.state=vachan.Fulfilled,this.value=e;for(let t of this.success_handler)this.queueTask(()=>t(e))}}reject(e){if(this.state===vachan.Pending){this.state=vachan.Rejected,this.value=e;for(let t of this.failure_handler)this.queueTask(()=>t(e))}}queueTask(e){this.async?this.type===vachan.Micro?process.nextTick(e):this.type===vachan.Macro&&setTimeout(e,0):e()}then(e,t){return"function"!=typeof e&&(e=void 0),"function"!=typeof t&&(t=void 0),new P((a,n,s)=>{let i=e=>{if(null==e)a(e);else if(e===s)n(new TypeError("It cannot return the same Promise"));else if(e instanceof P){let t=!1,a=!1;e.then(e=>{t||a||i(e),called=!0},e=>{t||a||n(e),called=!0})}else if(e instanceof Object||e instanceof Function||"object"==typeof e||"function"==typeof e){let t=!1,s=!1;try{let h=e.then;void 0!==h&&h instanceof Function&&"function"==typeof h?h.call(e,e=>{t||s||i(e),t=!0},e=>{t||s||n(e),s=!0}):a(e)}catch(e){t||s||n(e)}}else a(e)},h=e=>t=>{let a;try{a=e(t),i(a)}catch(e){n(e)}};this.state==vachan.Fulfilled?e?this.queueTask(()=>h(e)(this.value)):this.queueTask(()=>a(this.value)):this.state==vachan.Rejected?t?this.queueTask(()=>h(t)(this.value)):this.queueTask(()=>n(this.value)):(e?this.success_handler.push(h(e)):this.success_handler.push(a),t?this.failure_handler.push(h(t)):this.failure_handler.push(n))})}catch(e){return this.then(void 0,e)}finally(e){return this.then(e,e)}}vachan.P=P,"undefined"==typeof window?(vachan.default_type=vachan.Micro,module.exports.P=P,module.exports.Macro=vachan.Macro,module.exports.Micro=vachan.Micro):vachan.P.ajax=function(e,t){return new P((e,t)=>{})};